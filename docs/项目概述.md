### OneNote COM 插件 (TeXShift) 项目概述

**一、项目核心**

一个离线的、基于COM的OneNote插件，功能是在用户当前选中的**文本框（光标模式）**或**文字（选区模式）**上，实现 **OneNote 富文本等原生格式** 与 **Markdown/LaTeX 等纯文本格式** 的**双向切换**。

#### **核心功能**
1. **一键转换（Ribbon按钮 + 下拉）**  

Markdown/LaTeX/代码块/mermaid图表记为A类；原生格式包括OMML公式和带缓存的：代码块转换为的富文本高亮/mermaid转换为的PNG图/markdown转换为的文本，记为B类。

点击一键转换自动识别选区内容，有A类则转为B类，全为B类则转为A类。下拉菜单则可以自己选择转换方向。

2. **预览窗格（Ribbon开关）**  
- 渲染/解析另一类的内容，逻辑依然为选区内有A类则默认显示B类，全为B类则显示A类
- “互换”按钮：将预览窗格的内容与选区内容互换
- 尽量做编辑选区内容时，预览窗格的实时刷新的渲染/解析
- 尽量做上下滚动同步

3. **批量处理按钮（当前页）**  
- 整页转换
- 显示成功数、失败数和内容、耗时

4. **插件设置**  
- 快捷键配置（至少包括）：  
	- 一键转换
	- 打开/关闭预览窗格
	- 预览窗格的互换
- 样式映射规则（Markdown各级标题对应字号，代码块渲染的背景色等等）
- 缓存开关（默认开启） + 清理按钮

#### **其它细节**

所有功能需要可以离线使用
“选区”指上文的文本框（光标模式）或文字（选区模式）中的内容
Mermaid 插入格式用 PNG
Mermaid主题默认浅色，代码块背景默认深色吧，不复杂的话最好能在插件设置里设置
回 Markdown/LaTeX 时忽略颜色、字体族等，避免开发成本与不稳定回环，并且作对应提示